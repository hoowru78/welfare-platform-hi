<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Î≥µÏßÄ Ï∂îÏ≤ú Í≤∞Í≥º - ÎÇ®Ìï¥Íµ∞ ÎÖ∏Ïù∏ Î≥µÏßÄ Ï∂îÏ≤ú</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Ìè∞Ìä∏ -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Ïª§Ïä§ÌÖÄ Ïä§ÌÉÄÏùº -->
    <style>
        :root {
            --primary-500: #265DAB;
            --primary-600: #1e40af;
            --primary-100: #dbeafe;
            --secondary-100: #E9F0FA;
            --accent-400: #FFE66D;
            --neutral-50: #F9F9F9;
            --neutral-600: #4A4A4A;
            --success-500: #10b981;
            --warning-500: #f59e0b;
        }
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: var(--neutral-50);
        }
        
        .text-size-normal {
            font-size: 1.125rem;
            line-height: 1.7;
        }
        
        .text-size-medium {
            font-size: 1.375rem;
            line-height: 1.6;
        }
        
        .text-size-large {
            font-size: 1.5rem;
            line-height: 1.5;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-height: 44px;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            font-size: 1.125rem;
            line-height: 1.5;
            transition: all 0.2s;
            cursor: pointer;
            border: none;
            text-decoration: none;
        }
        
        .btn-primary {
            background-color: var(--primary-500);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--primary-600);
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            background-color: var(--secondary-100);
            color: var(--primary-600);
            border: 1px solid #cbd5e1;
        }
        
        .btn-secondary:hover {
            background-color: #e2e8f0;
        }
        
        .btn-outline {
            background-color: transparent;
            color: var(--primary-600);
            border: 2px solid var(--primary-500);
        }
        
        .btn-outline:hover {
            background-color: var(--primary-500);
            color: white;
        }
        
        .btn-accessibility {
            min-height: 40px;
            min-width: 40px;
            padding: 0.5rem;
            border-radius: 0.5rem;
            background-color: white;
            border: 1px solid #cbd5e1;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-accessibility:hover {
            background-color: var(--primary-100);
            border-color: var(--primary-500);
        }
        
        .welfare-card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e5e7eb;
            overflow: hidden;
            transition: all 0.3s ease;
            margin-bottom: 1.5rem;
        }
        
        .welfare-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        
        .welfare-card.priority-1 {
            border-left: 4px solid var(--primary-500);
        }
        
        .welfare-card.priority-2 {
            border-left: 4px solid var(--accent-400);
        }
        
        .welfare-card.priority-3 {
            border-left: 4px solid var(--success-500);
        }
        
        .welfare-card.priority-4 {
            border-left: 4px solid var(--warning-500);
        }
        
        .welfare-card.priority-5 {
            border-left: 4px solid #8b5cf6;
        }
        
        .priority-badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 600;
            margin-right: 0.5rem;
        }
        
        .priority-badge.priority-1 {
            background-color: var(--primary-500);
            color: white;
        }
        
        .priority-badge.priority-2 {
            background-color: var(--accent-400);
            color: var(--neutral-600);
        }
        
        .priority-badge.priority-3 {
            background-color: var(--success-500);
            color: white;
        }
        
        .category-badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }
        
        .category-badge.health {
            background-color: #dcfce7;
            color: #166534;
        }
        
        .category-badge.life {
            background-color: #fef3c7;
            color: #92400e;
        }
        
        .category-badge.economic {
            background-color: #dbeafe;
            color: #1e40af;
        }
        
        .category-badge.social {
            background-color: #f3e8ff;
            color: #7c3aed;
        }
        
        .category-badge.housing {
            background-color: #fed7aa;
            color: #c2410c;
        }
        
        .floating-voice {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background-color: var(--primary-500);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            transition: all 0.2s;
        }
        
        .floating-voice:hover {
            background-color: var(--primary-600);
            transform: scale(1.1);
        }
        
        .high-contrast {
            background-color: #000000 !important;
            color: #ffffff !important;
        }
        
        .high-contrast .welfare-card {
            background-color: #1a1a1a !important;
            border-color: #ffffff !important;
            color: #ffffff !important;
        }
        
        .high-contrast .btn-primary {
            background-color: #ffff00 !important;
            color: #000000 !important;
        }
        
        .result-header {
            background: linear-gradient(135deg, var(--primary-500), var(--primary-600));
            color: white;
            padding: 3rem 1rem;
            text-align: center;
        }
        
        .result-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }
        
        .stat-card {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 1.5rem;
            border-radius: 0.75rem;
            text-align: center;
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            display: block;
        }
        
        .stat-label {
            font-size: 0.875rem;
            opacity: 0.9;
            margin-top: 0.25rem;
        }
        
        @media (max-width: 768px) {
            .btn {
                min-height: 48px;
                padding: 0.875rem 1.5rem;
            }
            
            .welfare-card {
                margin-bottom: 1rem;
            }
            
            .result-stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body class="min-h-screen text-size-normal" id="main-body">
    <!-- Ï†ëÍ∑ºÏÑ± Ïä§ÌÇµ ÎßÅÌÅ¨ -->
    <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-0 focus:left-0 bg-blue-600 text-white p-2 z-50">
        Î≥∏Î¨∏ÏúºÎ°ú Í±¥ÎÑàÎõ∞Í∏∞
    </a>
    
    <!-- Ìó§Îçî -->
    <header class="bg-white shadow-sm border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center gap-3">
                    <div class="h-12 w-12 bg-blue-600 rounded-full flex items-center justify-center">
                        <span class="text-white font-bold text-xl">ÎÇ®</span>
                    </div>
                    <h1 class="text-2xl font-bold text-gray-800">
                        ÎÇ®Ìï¥Íµ∞ ÎÖ∏Ïù∏ Î≥µÏßÄ Ï∂îÏ≤ú
                    </h1>
                </div>
                
                <!-- Ï†ëÍ∑ºÏÑ± ÎèÑÍµ¨ -->
                <div class="flex items-center gap-2">
                    <button id="font-size-btn" class="btn-accessibility" title="Í∏ÄÏûê ÌÅ¨Í∏∞ Ï°∞Ï†à" aria-label="Í∏ÄÏûê ÌÅ¨Í∏∞ Ï°∞Ï†à">
                        <span class="font-bold">Í∞Ä</span>
                    </button>
                    <button id="voice-toggle-btn" class="btn-accessibility" title="ÏùåÏÑ± ÏïàÎÇ¥ ÌÜ†Í∏Ä" aria-label="ÏùåÏÑ± ÏïàÎÇ¥ ÌÜ†Í∏Ä">
                        üîä
                    </button>
                    <button id="high-contrast-btn" class="btn-accessibility" title="Í≥†ÎåÄÎπÑ Î™®Îìú" aria-label="Í≥†ÎåÄÎπÑ Î™®Îìú">
                        üåì
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Í≤∞Í≥º Ìó§Îçî -->
    <div class="result-header">
        <div class="max-w-7xl mx-auto">
            <div class="text-6xl mb-4">üéâ</div>
            <h2 class="text-3xl font-bold mb-2">Î≥µÏßÄ ÌòúÌÉù Ï∂îÏ≤ú Í≤∞Í≥º</h2>
            <p class="text-blue-100 text-lg mb-2" id="user-greeting">
                Ïñ¥Î•¥Ïã†Íªò ÎßûÎäî Î≥µÏßÄ ÌòúÌÉùÏùÑ Ï∞æÏïòÏäµÎãàÎã§
            </p>
            <p class="text-blue-200 text-sm" id="completion-date">
                <!-- ÏôÑÎ£å ÎÇ†ÏßúÍ∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
            </p>
            
            <div class="result-stats" id="result-stats">
                <div class="stat-card">
                    <span class="stat-number" id="total-recommendations">0</span>
                    <span class="stat-label">Ï∂îÏ≤ú Î≥µÏßÄ ÌòúÌÉù</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="confidence-score">0%</span>
                    <span class="stat-label">Î∂ÑÏÑù Ï†ïÌôïÎèÑ</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="user-key-display">-</span>
                    <span class="stat-label">Ï°∞Ìöå ÌÇ§</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Î©îÏù∏ ÏΩòÌÖêÏ∏† -->
    <main id="main-content" class="max-w-7xl mx-auto px-4 py-8">
        <div class="max-w-4xl mx-auto">
            <!-- Ï∂îÏ≤ú Í≤∞Í≥º Î™©Î°ù -->
            <div id="recommendations-container">
                <!-- Ï∂îÏ≤ú Í≤∞Í≥ºÍ∞Ä ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê©ÎãàÎã§ -->
            </div>

            <!-- ÌïòÎã® Ïï°ÏÖò -->
            <div class="mt-12 bg-white rounded-lg p-6 shadow-sm border border-gray-200">
                <div class="text-center">
                    <h3 class="text-xl font-semibold mb-4">Í≤∞Í≥ºÎ•º Ï†ÄÏû•ÌïòÍ≥† ÎÇòÏ§ëÏóê ÌôïÏù∏ÌïòÏÑ∏Ïöî</h3>
                    <p class="text-gray-600 mb-6">
                        ÏúÑÏùò <strong id="user-key-text">Ï°∞Ìöå ÌÇ§</strong>Î•º Í∏∞Î°ùÌï¥ÎëêÏãúÎ©¥ Ïñ∏Ï†úÎì†ÏßÄ Í≤∞Í≥ºÎ•º Îã§Ïãú ÌôïÏù∏Ìï† Ïàò ÏûàÏäµÎãàÎã§.
                    </p>
                    <div class="flex flex-col sm:flex-row justify-center gap-4">
                        <button id="print-btn" class="btn btn-primary">
                            üñ®Ô∏è Í≤∞Í≥º Ïù∏ÏáÑÌïòÍ∏∞
                        </button>
                        <button id="save-btn" class="btn btn-secondary">
                            üì± Ï°∞Ìöå ÌÇ§ Ï†ÄÏû•ÌïòÍ∏∞
                        </button>
                        <button id="new-survey-btn" class="btn btn-outline">
                            üîÑ ÏÉàÎ°úÏö¥ ÏÑ§Î¨∏ÌïòÍ∏∞
                        </button>
                    </div>
                </div>
            </div>

            <!-- Ï∂îÍ∞Ä ÎèÑÏõÄÎßê -->
            <div class="mt-8 bg-blue-50 rounded-lg p-6 border border-blue-200">
                <h3 class="text-lg font-semibold text-blue-900 mb-3">üìã Î≥µÏßÄ Ïã†Ï≤≠ ÎèÑÏõÄÎßê</h3>
                <div class="text-blue-800 space-y-2">
                    <p>‚Ä¢ Î≥µÏßÄ Ïã†Ï≤≠ Ïãú Ïã†Î∂ÑÏ¶ùÍ≥º Í¥ÄÎ†® ÏÑúÎ•òÎ•º Ï§ÄÎπÑÌï¥Ï£ºÏÑ∏Ïöî</p>
                    <p>‚Ä¢ Ïùç¬∑Î©¥ ÌñâÏ†ïÎ≥µÏßÄÏÑºÌÑ∞ÏóêÏÑú ÏßÅÏ†ë ÎèÑÏõÄÏùÑ Î∞õÏùÑ Ïàò ÏûàÏäµÎãàÎã§</p>
                    <p>‚Ä¢ Î¨∏ÏùòÏÇ¨Ìï≠Ïù¥ ÏûàÏúºÏãúÎ©¥ ÎÇ®Ìï¥Íµ∞Ï≤≠ Î≥µÏßÄÏ†ïÏ±ÖÍ≥º(055-860-8300)Î°ú Ïó∞ÎùΩÏ£ºÏÑ∏Ïöî</p>
                </div>
            </div>
        </div>
    </main>

    <!-- Ìë∏ÌÑ∞ -->
    <footer class="bg-gray-800 text-white mt-16">
        <div class="max-w-7xl mx-auto px-4 py-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <h4 class="text-lg font-semibold mb-4">ÎÇ®Ìï¥Íµ∞Ï≤≠</h4>
                    <p class="text-gray-300">Í≤ΩÏÉÅÎÇ®ÎèÑ ÎÇ®Ìï¥Íµ∞ ÎÇ®Ìï¥Ïùç ÌôçÌòÑÍ∏∏ 35</p>
                    <p class="text-gray-300">Ï†ÑÌôî: 055-860-8000</p>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4">Î¨∏Ïùò Î∞è ÎèÑÏõÄ</h4>
                    <p class="text-gray-300">Î≥µÏßÄÏ†ïÏ±ÖÍ≥º: 055-860-8300</p>
                    <p class="text-gray-300">Í∏∞Ïà†ÏßÄÏõê: 055-860-8100</p>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4">Ïù¥Ïö© ÏïàÎÇ¥</h4>
                    <a href="#" class="text-gray-300 hover:text-white block">ÏÇ¨Ïö© Î∞©Î≤ï</a>
                    <a href="#" class="text-gray-300 hover:text-white block">Í∞úÏù∏Ï†ïÎ≥¥ Ï≤òÎ¶¨Î∞©Ïπ®</a>
                </div>
            </div>
            <div class="mt-8 pt-8 border-t border-gray-700 text-center text-gray-400">
                <p>&copy; 2024 ÎÇ®Ìï¥Íµ∞Ï≤≠. Î™®Îì† Í∂åÎ¶¨ Î≥¥Ïú†.</p>
            </div>
        </div>
    </footer>

    <!-- ÌîåÎ°úÌåÖ ÏùåÏÑ± Î≤ÑÌäº -->
    <div class="floating-voice" id="floating-voice-btn" title="ÏùåÏÑ± ÏïàÎÇ¥" aria-label="ÏùåÏÑ± ÏïàÎÇ¥ Î≤ÑÌäº">
        üîä
    </div>

    <!-- Î≥µÏßÄ ÏÉÅÏÑ∏ Ï†ïÎ≥¥ Î™®Îã¨ -->
    <div id="welfare-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen px-4">
            <div class="bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-xl font-bold" id="modal-title">Î≥µÏßÄ ÏÉÅÏÑ∏ Ï†ïÎ≥¥</h3>
                        <button id="modal-close" class="text-gray-400 hover:text-gray-600">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <div id="modal-content">
                        <!-- Î™®Îã¨ ÎÇ¥Ïö©Ïù¥ ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê©ÎãàÎã§ -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Ï†ÑÏó≠ Î≥ÄÏàò
        let isVoiceEnabled = false;
        let isHighContrast = false;
        let fontSizeLevel = 1;
        let speechSynthesis = window.speechSynthesis;
        let resultData = null;
        
        // API Í∏∞Î≥∏ URL
        const API_BASE_URL = 'http://localhost:5000/api';
        
        // DOM ÏöîÏÜåÎì§
        const recommendationsContainer = document.getElementById('recommendations-container');
        const userGreeting = document.getElementById('user-greeting');
        const completionDate = document.getElementById('completion-date');
        const totalRecommendations = document.getElementById('total-recommendations');
        const confidenceScore = document.getElementById('confidence-score');
        const userKeyDisplay = document.getElementById('user-key-display');
        const userKeyText = document.getElementById('user-key-text');
        const printBtn = document.getElementById('print-btn');
        const saveBtn = document.getElementById('save-btn');
        const newSurveyBtn = document.getElementById('new-survey-btn');
        const welfareModal = document.getElementById('welfare-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalContent = document.getElementById('modal-content');
        const modalClose = document.getElementById('modal-close');
        const fontSizeBtn = document.getElementById('font-size-btn');
        const voiceToggleBtn = document.getElementById('voice-toggle-btn');
        const highContrastBtn = document.getElementById('high-contrast-btn');
        const floatingVoiceBtn = document.getElementById('floating-voice-btn');
        const mainBody = document.getElementById('main-body');
        
        // Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', function() {
            loadUserPreferences();
            initializeEventListeners();
            loadResults();
        });
        
        // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Ï¥àÍ∏∞Ìôî
        function initializeEventListeners() {
            printBtn.addEventListener('click', printResults);
            saveBtn.addEventListener('click', saveUserKey);
            newSurveyBtn.addEventListener('click', startNewSurvey);
            modalClose.addEventListener('click', closeModal);
            
            // Ï†ëÍ∑ºÏÑ± Î≤ÑÌäºÎì§
            fontSizeBtn.addEventListener('click', toggleFontSize);
            voiceToggleBtn.addEventListener('click', toggleVoice);
            highContrastBtn.addEventListener('click', toggleHighContrast);
            floatingVoiceBtn.addEventListener('click', toggleVoice);
            
            // Î™®Îã¨ Î∞∞Í≤Ω ÌÅ¥Î¶≠ Ïãú Îã´Í∏∞
            welfareModal.addEventListener('click', function(e) {
                if (e.target === welfareModal) {
                    closeModal();
                }
            });
            
            // ÌÇ§Î≥¥Îìú Ï†ëÍ∑ºÏÑ±
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeModal();
                }
            });
        }
        
        // Í≤∞Í≥º Îç∞Ïù¥ÌÑ∞ Î°úÎìú
        async function loadResults() {
            // URLÏóêÏÑú userKey ÌååÎùºÎØ∏ÌÑ∞ Ï∂îÏ∂ú
            const urlParams = new URLSearchParams(window.location.search);
            const userKey = urlParams.get('userKey');
            
            if (!userKey) {
                alert('ÏûòÎ™ªÎêú Ï†ëÍ∑ºÏûÖÎãàÎã§.');
                window.location.href = 'index.html';
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE_URL}/results/${userKey}`);
                const data = await response.json();
                
                if (response.ok) {
                    resultData = data;
                    displayResults(data);
                    
                    if (isVoiceEnabled) {
                        speak(`${data.user_name}ÎãòÏùò Î≥µÏßÄ Ï∂îÏ≤ú Í≤∞Í≥ºÎ•º Î∂àÎü¨ÏôîÏäµÎãàÎã§.`);
                    }
                } else {
                    alert('Í≤∞Í≥ºÎ•º Î∂àÎü¨Ïò§ÎäîÎç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§: ' + data.error);
                    window.location.href = 'index.html';
                }
            } catch (error) {
                console.error('Error:', error);
                alert('ÏÑúÎ≤Ñ Ïó∞Í≤∞Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.');
                window.location.href = 'index.html';
            }
        }
        
        // Í≤∞Í≥º ÌëúÏãú
        function displayResults(data) {
            // Ìó§Îçî Ï†ïÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏
            userGreeting.textContent = `${data.user_name}ÎãòÍªò ÎßûÎäî ${data.recommendations.length}Í∞ÄÏßÄ Î≥µÏßÄ ÌòúÌÉùÏùÑ Ï∞æÏïòÏäµÎãàÎã§`;
            completionDate.textContent = `ÏôÑÎ£åÏùº: ${formatDate(data.completion_time)}`;
            
            // ÌÜµÍ≥Ñ Ï†ïÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏
            totalRecommendations.textContent = data.recommendations.length;
            confidenceScore.textContent = `${Math.round(data.confidence_score || 85)}%`;
            
            // userKey Ï∂îÏ∂ú (URLÏóêÏÑú)
            const urlParams = new URLSearchParams(window.location.search);
            const userKey = urlParams.get('userKey');
            userKeyDisplay.textContent = userKey;
            userKeyText.textContent = userKey;
            
            // Ï∂îÏ≤ú Í≤∞Í≥º Î†åÎçîÎßÅ
            renderRecommendations(data.recommendations);
        }
        
        // Ï∂îÏ≤ú Í≤∞Í≥º Î†åÎçîÎßÅ
        function renderRecommendations(recommendations) {
            recommendationsContainer.innerHTML = '';
            
            recommendations.forEach((welfare, index) => {
                const welfareCard = document.createElement('div');
                welfareCard.className = `welfare-card priority-${welfare.priority}`;
                
                const categoryClass = getCategoryClass(welfare.category);
                
                welfareCard.innerHTML = `
                    <div class="p-6">
                        <div class="flex items-start justify-between">
                            <div class="flex-1">
                                <div class="flex items-center gap-2 mb-3">
                                    <span class="priority-badge priority-${welfare.priority}">
                                        ${welfare.priority}ÏàúÏúÑ
                                    </span>
                                    <span class="category-badge ${categoryClass}">
                                        ${getCategoryIcon(welfare.category)} ${welfare.category}
                                    </span>
                                </div>
                                <h3 class="text-xl font-bold text-gray-800 mb-2">
                                    ${welfare.name}
                                </h3>
                                <p class="text-gray-600 mb-4">
                                    ${welfare.description}
                                </p>
                                <div class="flex flex-wrap items-center gap-4 text-sm text-gray-500 mb-4">
                                    <span>üí∞ ${welfare.benefit_amount}</span>
                                    <span>üìã ${welfare.benefit_type}</span>
                                    <span>üéØ Ï†ÅÌï©ÎèÑ ${welfare.match_score}%</span>
                                </div>
                            </div>
                            <div class="ml-4">
                                <div class="text-4xl">${getCategoryIcon(welfare.category)}</div>
                            </div>
                        </div>
                        <div class="mt-6 flex gap-3">
                            <button class="btn btn-primary" onclick="showWelfareDetails('${welfare.id}')">
                                Ïã†Ï≤≠ Î∞©Î≤ï Î≥¥Í∏∞
                            </button>
                            <button class="btn btn-secondary" onclick="showWelfareDetails('${welfare.id}')">
                                ÏÉÅÏÑ∏ Ï†ïÎ≥¥
                            </button>
                            <button class="btn btn-outline" onclick="speakWelfare('${welfare.name}', '${welfare.description}')">
                                üîä ÏùåÏÑ± ÏïàÎÇ¥
                            </button>
                        </div>
                    </div>
                `;
                
                recommendationsContainer.appendChild(welfareCard);
            });
        }
        
        // Î≥µÏßÄ ÏÉÅÏÑ∏ Ï†ïÎ≥¥ ÌëúÏãú
        function showWelfareDetails(welfareId) {
            const welfare = resultData.recommendations.find(w => w.id === welfareId);
            
            if (!welfare) {
                alert('Î≥µÏßÄ Ï†ïÎ≥¥Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.');
                return;
            }
            
            modalTitle.textContent = welfare.name;
            modalContent.innerHTML = `
                <div class="space-y-6">
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-2">üìã ÏßÄÏõê ÎÇ¥Ïö©</h4>
                        <p class="text-gray-600">${welfare.description}</p>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <h4 class="font-semibold text-gray-800 mb-2">üí∞ ÏßÄÏõê Í∏àÏï°</h4>
                            <p class="text-gray-600">${welfare.benefit_amount}</p>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-800 mb-2">üì¶ ÏßÄÏõê ÌòïÌÉú</h4>
                            <p class="text-gray-600">${welfare.benefit_type}</p>
                        </div>
                    </div>
                    
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-2">üìù Ïã†Ï≤≠ Î∞©Î≤ï</h4>
                        <div class="bg-gray-50 p-4 rounded-lg">
                            ${getApplicationMethod(welfare)}
                        </div>
                    </div>
                    
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-2">üìÑ ÌïÑÏöî ÏÑúÎ•ò</h4>
                        <div class="bg-gray-50 p-4 rounded-lg">
                            ${getRequiredDocuments(welfare)}
                        </div>
                    </div>
                    
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-2">üìû Î¨∏ÏùòÏ≤ò</h4>
                        <div class="bg-blue-50 p-4 rounded-lg">
                            ${getContactInfo(welfare)}
                        </div>
                    </div>
                </div>
            `;
            
            welfareModal.classList.remove('hidden');
            
            if (isVoiceEnabled) {
                speak(`${welfare.name}Ïùò ÏÉÅÏÑ∏ Ï†ïÎ≥¥Î•º ÌëúÏãúÌï©ÎãàÎã§.`);
            }
        }
        
        // Î™®Îã¨ Îã´Í∏∞
        function closeModal() {
            welfareModal.classList.add('hidden');
        }
        
        // Î≥µÏßÄ ÏùåÏÑ± ÏïàÎÇ¥
        function speakWelfare(name, description) {
            speak(`${name}. ${description}`);
        }
        
        // Í≤∞Í≥º Ïù∏ÏáÑ
        function printResults() {
            if (isVoiceEnabled) {
                speak('Í≤∞Í≥ºÎ•º Ïù∏ÏáÑÌï©ÎãàÎã§.');
            }
            
            window.print();
        }
        
        // Ï°∞Ìöå ÌÇ§ Ï†ÄÏû•
        function saveUserKey() {
            const urlParams = new URLSearchParams(window.location.search);
            const userKey = urlParams.get('userKey');
            
            if (navigator.clipboard) {
                navigator.clipboard.writeText(userKey).then(() => {
                    alert(`Ï°∞Ìöå ÌÇ§ "${userKey}"Í∞Ä ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§.`);
                    
                    if (isVoiceEnabled) {
                        speak('Ï°∞Ìöå ÌÇ§Í∞Ä ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§.');
                    }
                }).catch(() => {
                    alert(`Ï°∞Ìöå ÌÇ§: ${userKey}\n\nÏù¥ ÌÇ§Î•º Í∏∞Î°ùÌï¥ÎëêÏÑ∏Ïöî.`);
                });
            } else {
                alert(`Ï°∞Ìöå ÌÇ§: ${userKey}\n\nÏù¥ ÌÇ§Î•º Í∏∞Î°ùÌï¥ÎëêÏÑ∏Ïöî.`);
            }
        }
        
        // ÏÉàÎ°úÏö¥ ÏÑ§Î¨∏ ÏãúÏûë
        function startNewSurvey() {
            if (confirm('ÏÉàÎ°úÏö¥ ÏÑ§Î¨∏ÏùÑ ÏãúÏûëÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                window.location.href = 'index.html';
            }
        }
        
        // Ïú†Ìã∏Î¶¨Ìã∞ Ìï®ÏàòÎì§
        function getCategoryClass(category) {
            const categoryMap = {
                'Í±¥Í∞ïÏùòÎ£å': 'health',
                'ÏÉùÌôúÏßÄÏõê': 'life',
                'Í≤ΩÏ†úÏßÄÏõê': 'economic',
                'ÏÇ¨ÌöåÏ∞∏Ïó¨': 'social',
                'Ï£ºÍ±∞ÏßÄÏõê': 'housing'
            };
            return categoryMap[category] || 'health';
        }
        
        function getCategoryIcon(category) {
            const iconMap = {
                'Í±¥Í∞ïÏùòÎ£å': 'üè•',
                'ÏÉùÌôúÏßÄÏõê': 'üè†',
                'Í≤ΩÏ†úÏßÄÏõê': 'üí∞',
                'ÏÇ¨ÌöåÏ∞∏Ïó¨': 'üë•',
                'Ï£ºÍ±∞ÏßÄÏõê': 'üè°'
            };
            return iconMap[category] || 'üìã';
        }
        
        function getApplicationMethod(welfare) {
            const methodMap = {
                'basic_pension': 'Ïùç¬∑Î©¥ ÌñâÏ†ïÎ≥µÏßÄÏÑºÌÑ∞ Î∞©Î¨∏ ÎòêÎäî Ïò®ÎùºÏù∏ Ïã†Ï≤≠<br><a href="https://www.bokjiro.go.kr" target="_blank" class="text-blue-600">Î≥µÏßÄÎ°ú Î∞îÎ°úÍ∞ÄÍ∏∞</a>',
                'namhae_customized_care': 'Í±∞Ï£ºÏßÄ Í¥ÄÌï† Ïùç¬∑Î©¥ ÌñâÏ†ïÎ≥µÏßÄÏÑºÌÑ∞ Î∞©Î¨∏ ÎòêÎäî Ï†ÑÌôî ÏÉÅÎã¥<br>Ï†ÑÌôî: 055-860-8300',
                'health_medical_support': 'Í¥ÄÌï† Î≥¥Í±¥ÏÜå Î∞©Î¨∏ Ïã†Ï≤≠<br>ÎÇ®Ìï¥Íµ∞ Î≥¥Í±¥ÏÜå: 055-860-8000',
                'senior_jobs': 'Ïãú¬∑Íµ∞¬∑Íµ¨ ÎòêÎäî ÏàòÌñâÍ∏∞Í¥ÄÏóêÏÑú Í¥ÄÎ†® ÏÑúÎ•ò Ï†úÏ∂ú<br>ÎÇ®Ìï¥Íµ∞Ï≤≠ ÎÖ∏Ïù∏Î≥µÏßÄÍ≥º: 055-860-8300',
                'senior_housing': 'Ìï¥Îãπ ÏãúÏÑ§ ÎòêÎäî Ïãú¬∑Íµ∞¬∑Íµ¨ Îã¥Îãπ Î∂ÄÏÑúÏóê Î¨∏Ïùò',
                'basic_livelihood': 'Í±∞Ï£ºÏßÄ Í¥ÄÌï† Ïùç¬∑Î©¥ ÌñâÏ†ïÎ≥µÏßÄÏÑºÌÑ∞ Î∞©Î¨∏ Ïã†Ï≤≠'
            };
            return methodMap[welfare.id] || 'Í¥ÄÌï† ÌñâÏ†ïÎ≥µÏßÄÏÑºÌÑ∞ ÎòêÎäî ÎÇ®Ìï¥Íµ∞Ï≤≠ Î≥µÏßÄÏ†ïÏ±ÖÍ≥º(055-860-8300)Ïóê Î¨∏ÏùòÌï¥Ï£ºÏÑ∏Ïöî.';
        }
        
        function getRequiredDocuments(welfare) {
            const docMap = {
                'basic_pension': '‚Ä¢ Ïã†Î∂ÑÏ¶ù<br>‚Ä¢ Í∏∞Ï¥àÏó∞Í∏à Ïã†Ï≤≠ÏÑú<br>‚Ä¢ ÏÜåÎìùÏû¨ÏÇ∞ Ïã†Í≥†ÏÑú<br>‚Ä¢ ÌÜµÏû• ÏÇ¨Î≥∏',
                'namhae_customized_care': '‚Ä¢ Ïã†Î∂ÑÏ¶ù<br>‚Ä¢ ÏÜåÎìù ÌôïÏù∏ ÏÑúÎ•ò<br>‚Ä¢ Í±¥Í∞ï ÏÉÅÌÉú ÌôïÏù∏ÏÑú(Ìï¥ÎãπÏãú)',
                'health_medical_support': '‚Ä¢ Ïã†Î∂ÑÏ¶ù<br>‚Ä¢ ÏùòÎ£åÏßÑÎã®ÏÑú<br>‚Ä¢ ÏÜåÎìù ÌôïÏù∏ ÏÑúÎ•ò<br>‚Ä¢ ÏùòÎ£åÎπÑ ÏòÅÏàòÏ¶ù',
                'senior_jobs': '‚Ä¢ Ïã†Î∂ÑÏ¶ù<br>‚Ä¢ Ï∞∏Ïó¨Ïã†Ï≤≠ÏÑú<br>‚Ä¢ Í∞úÏù∏Ï†ïÎ≥¥ ÏàòÏßë ÎèôÏùòÏÑú<br>‚Ä¢ Í¥ÄÎ†® ÏûêÍ≤©Ï¶ù(Ìï¥ÎãπÏãú)',
                'senior_housing': '‚Ä¢ Ïã†Î∂ÑÏ¶ù<br>‚Ä¢ ÏÜåÎìù ÌôïÏù∏ ÏÑúÎ•ò<br>‚Ä¢ Í±¥Í∞ïÏßÑÎã®ÏÑú<br>‚Ä¢ ÏûÖÏÜå Ïã†Ï≤≠ÏÑú',
                'basic_livelihood': '‚Ä¢ Ïã†Î∂ÑÏ¶ù<br>‚Ä¢ ÏÜåÎìù ÌôïÏù∏ ÏÑúÎ•ò<br>‚Ä¢ Ïû¨ÏÇ∞ ÌôïÏù∏ ÏÑúÎ•ò<br>‚Ä¢ Í∞ÄÏ°±Í¥ÄÍ≥Ñ Ï¶ùÎ™ÖÏÑú'
            };
            return docMap[welfare.id] || 'ÏûêÏÑ∏Ìïú ÏÑúÎ•òÎäî Ìï¥Îãπ Í∏∞Í¥ÄÏóê Î¨∏ÏùòÌï¥Ï£ºÏÑ∏Ïöî.';
        }
        
        function getContactInfo(welfare) {
            const contactMap = {
                'basic_pension': 'Íµ≠ÎØºÏó∞Í∏àÍ≥µÎã® ÏΩúÏÑºÌÑ∞: 1355<br>ÎÇ®Ìï¥Íµ∞Ï≤≠ Î≥µÏßÄÏ†ïÏ±ÖÍ≥º: 055-860-8300',
                'namhae_customized_care': 'ÎÇ®Ìï¥Íµ∞Ï≤≠ ÎÖ∏Ïù∏Î≥µÏßÄÍ≥º: 055-860-8300',
                'health_medical_support': 'ÎÇ®Ìï¥Íµ∞ Î≥¥Í±¥ÏÜå: 055-860-8000',
                'senior_jobs': 'ÎÇ®Ìï¥Íµ∞Ï≤≠ ÎÖ∏Ïù∏Î≥µÏßÄÍ≥º: 055-860-8300',
                'senior_housing': 'ÎÇ®Ìï¥Íµ∞Ï≤≠ Î≥µÏßÄÏ†ïÏ±ÖÍ≥º: 055-860-8300',
                'basic_livelihood': 'ÎÇ®Ìï¥Íµ∞Ï≤≠ Î≥µÏßÄÏ†ïÏ±ÖÍ≥º: 055-860-8300'
            };
            return contactMap[welfare.id] || 'ÎÇ®Ìï¥Íµ∞Ï≤≠ Î≥µÏßÄÏ†ïÏ±ÖÍ≥º: 055-860-8300<br>ÎÇ®Ìï¥Íµ∞Ï≤≠ ÎåÄÌëúÏ†ÑÌôî: 055-860-8000';
        }
        
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('ko-KR', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }
        
        // Ï†ëÍ∑ºÏÑ± Í∏∞Îä•Îì§ (Ïù¥Ï†Ñ ÌéòÏù¥ÏßÄÏôÄ ÎèôÏùº)
        function toggleFontSize() {
            fontSizeLevel = (fontSizeLevel % 3) + 1;
            
            const body = document.body;
            body.classList.remove('text-size-normal', 'text-size-medium', 'text-size-large');
            
            switch (fontSizeLevel) {
                case 1:
                    body.classList.add('text-size-normal');
                    break;
                case 2:
                    body.classList.add('text-size-medium');
                    break;
                case 3:
                    body.classList.add('text-size-large');
                    break;
            }
            
            localStorage.setItem('fontSizeLevel', fontSizeLevel);
            
            if (isVoiceEnabled) {
                speak(`Í∏ÄÏûê ÌÅ¨Í∏∞Î•º ${fontSizeLevel}Îã®Í≥ÑÎ°ú Ï°∞Ï†àÌñàÏäµÎãàÎã§.`);
            }
        }
        
        function toggleVoice() {
            isVoiceEnabled = !isVoiceEnabled;
            
            if (isVoiceEnabled) {
                voiceToggleBtn.classList.add('bg-blue-100', 'border-blue-500');
                floatingVoiceBtn.classList.add('bg-blue-700');
                speak('ÏùåÏÑ± ÏïàÎÇ¥Í∞Ä ÏºúÏ°åÏäµÎãàÎã§.');
            } else {
                voiceToggleBtn.classList.remove('bg-blue-100', 'border-blue-500');
                floatingVoiceBtn.classList.remove('bg-blue-700');
                
                if (speechSynthesis.speaking) {
                    speechSynthesis.cancel();
                }
            }
            
            localStorage.setItem('isVoiceEnabled', isVoiceEnabled);
        }
        
        function toggleHighContrast() {
            isHighContrast = !isHighContrast;
            
            if (isHighContrast) {
                mainBody.classList.add('high-contrast');
                highContrastBtn.classList.add('bg-yellow-400', 'border-yellow-600');
            } else {
                mainBody.classList.remove('high-contrast');
                highContrastBtn.classList.remove('bg-yellow-400', 'border-yellow-600');
            }
            
            localStorage.setItem('isHighContrast', isHighContrast);
            
            if (isVoiceEnabled) {
                speak(`Í≥†ÎåÄÎπÑ Î™®ÎìúÍ∞Ä ${isHighContrast ? 'ÏºúÏ°åÏäµÎãàÎã§' : 'Í∫ºÏ°åÏäµÎãàÎã§'}.`);
            }
        }
        
        function speak(text) {
            if (!speechSynthesis) return;
            
            if (speechSynthesis.speaking) {
                speechSynthesis.cancel();
            }
            
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'ko-KR';
            utterance.rate = 0.8;
            utterance.pitch = 1;
            
            speechSynthesis.speak(utterance);
        }
        
        function loadUserPreferences() {
            const savedFontSize = localStorage.getItem('fontSizeLevel');
            if (savedFontSize) {
                fontSizeLevel = parseInt(savedFontSize);
                const body = document.body;
                body.classList.remove('text-size-normal', 'text-size-medium', 'text-size-large');
                
                switch (fontSizeLevel) {
                    case 1:
                        body.classList.add('text-size-normal');
                        break;
                    case 2:
                        body.classList.add('text-size-medium');
                        break;
                    case 3:
                        body.classList.add('text-size-large');
                        break;
                }
            }
            
            const savedVoice = localStorage.getItem('isVoiceEnabled');
            if (savedVoice === 'true') {
                isVoiceEnabled = true;
                voiceToggleBtn.classList.add('bg-blue-100', 'border-blue-500');
                floatingVoiceBtn.classList.add('bg-blue-700');
            }
            
            const savedHighContrast = localStorage.getItem('isHighContrast');
            if (savedHighContrast === 'true') {
                isHighContrast = true;
                mainBody.classList.add('high-contrast');
                highContrastBtn.classList.add('bg-yellow-400', 'border-yellow-600');
            }
        }
    </script>
</body>
</html> 