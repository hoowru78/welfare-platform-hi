<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë³µì§€ ì¶”ì²œ ê²°ê³¼ - ë‚¨í•´êµ° ë…¸ì¸ ë³µì§€ ì¶”ì²œ</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- í°íŠ¸ -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼ -->
    <style>
        :root {
            --primary-500: #265DAB;
            --primary-600: #1e40af;
            --primary-100: #dbeafe;
            --secondary-100: #E9F0FA;
            --accent-400: #FFE66D;
            --neutral-50: #F9F9F9;
            --neutral-600: #4A4A4A;
            --success-500: #10b981;
            --warning-500: #f59e0b;
        }
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: var(--neutral-50);
        }
        
        .text-size-normal {
            font-size: 1.125rem;
            line-height: 1.7;
        }
        
        .text-size-medium {
            font-size: 1.375rem;
            line-height: 1.6;
        }
        
        .text-size-large {
            font-size: 1.5rem;
            line-height: 1.5;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-height: 44px;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            font-size: 1.125rem;
            line-height: 1.5;
            transition: all 0.2s;
            cursor: pointer;
            border: none;
            text-decoration: none;
        }
        
        .btn-primary {
            background-color: var(--primary-500);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--primary-600);
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            background-color: var(--secondary-100);
            color: var(--primary-600);
            border: 1px solid #cbd5e1;
        }
        
        .btn-secondary:hover {
            background-color: #e2e8f0;
        }
        
        .btn-outline {
            background-color: transparent;
            color: var(--primary-600);
            border: 2px solid var(--primary-500);
        }
        
        .btn-outline:hover {
            background-color: var(--primary-500);
            color: white;
        }
        
        .btn-accessibility {
            min-height: 40px;
            min-width: 40px;
            padding: 0.5rem;
            border-radius: 0.5rem;
            background-color: white;
            border: 1px solid #cbd5e1;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-accessibility:hover {
            background-color: var(--primary-100);
            border-color: var(--primary-500);
        }
        
        .welfare-card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e5e7eb;
            overflow: hidden;
            transition: all 0.3s ease;
            margin-bottom: 1.5rem;
        }
        
        .welfare-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        
        .welfare-card.priority-1 {
            border-left: 4px solid var(--primary-500);
        }
        
        .welfare-card.priority-2 {
            border-left: 4px solid var(--accent-400);
        }
        
        .welfare-card.priority-3 {
            border-left: 4px solid var(--success-500);
        }
        
        .welfare-card.priority-4 {
            border-left: 4px solid var(--warning-500);
        }
        
        .welfare-card.priority-5 {
            border-left: 4px solid #8b5cf6;
        }
        
        .priority-badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 600;
            margin-right: 0.5rem;
        }
        
        .priority-badge.priority-1 {
            background-color: var(--primary-500);
            color: white;
        }
        
        .priority-badge.priority-2 {
            background-color: var(--accent-400);
            color: var(--neutral-600);
        }
        
        .priority-badge.priority-3 {
            background-color: var(--success-500);
            color: white;
        }
        
        .category-badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }
        
        .category-badge.health {
            background-color: #dcfce7;
            color: #166534;
        }
        
        .category-badge.life {
            background-color: #fef3c7;
            color: #92400e;
        }
        
        .category-badge.economic {
            background-color: #dbeafe;
            color: #1e40af;
        }
        
        .category-badge.social {
            background-color: #f3e8ff;
            color: #7c3aed;
        }
        
        .category-badge.housing {
            background-color: #fed7aa;
            color: #c2410c;
        }
        
        .floating-voice {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background-color: var(--primary-500);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            transition: all 0.2s;
        }
        
        .floating-voice:hover {
            background-color: var(--primary-600);
            transform: scale(1.1);
        }
        
        .high-contrast {
            background-color: #000000 !important;
            color: #ffffff !important;
        }
        
        .high-contrast .welfare-card {
            background-color: #1a1a1a !important;
            border-color: #ffffff !important;
            color: #ffffff !important;
        }
        
        .high-contrast .btn-primary {
            background-color: #ffff00 !important;
            color: #000000 !important;
        }
        
        .result-header {
            background: linear-gradient(135deg, var(--primary-500), var(--primary-600));
            color: white;
            padding: 3rem 1rem;
            text-align: center;
        }
        
        .result-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }
        
        .stat-card {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 1.5rem;
            border-radius: 0.75rem;
            text-align: center;
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            display: block;
        }
        
        .stat-label {
            font-size: 0.875rem;
            opacity: 0.9;
            margin-top: 0.25rem;
        }
        
        @media (max-width: 768px) {
            .btn {
                min-height: 48px;
                padding: 0.875rem 1.5rem;
            }
            
            .welfare-card {
                margin-bottom: 1rem;
            }
            
            .result-stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body class="min-h-screen text-size-normal" id="main-body">
    <!-- ì ‘ê·¼ì„± ìŠ¤í‚µ ë§í¬ -->
    <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-0 focus:left-0 bg-blue-600 text-white p-2 z-50">
        ë³¸ë¬¸ìœ¼ë¡œ ê±´ë„ˆë›°ê¸°
    </a>
    
    <!-- í—¤ë” -->
    <header class="bg-white shadow-sm border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center gap-3">
                    <div class="h-12 w-12 bg-blue-600 rounded-full flex items-center justify-center">
                        <span class="text-white font-bold text-xl">ë‚¨</span>
                    </div>
                    <h1 class="text-2xl font-bold text-gray-800">
                        ë‚¨í•´êµ° ë…¸ì¸ ë³µì§€ ì¶”ì²œ
                    </h1>
                </div>
                
                <!-- ì ‘ê·¼ì„± ë„êµ¬ -->
                <div class="flex items-center gap-2">
                    <button id="font-size-btn" class="btn-accessibility" title="ê¸€ì í¬ê¸° ì¡°ì ˆ" aria-label="ê¸€ì í¬ê¸° ì¡°ì ˆ">
                        <span class="font-bold">ê°€</span>
                    </button>
                    <button id="voice-toggle-btn" class="btn-accessibility" title="ìŒì„± ì•ˆë‚´ í† ê¸€" aria-label="ìŒì„± ì•ˆë‚´ í† ê¸€">
                        ğŸ”Š
                    </button>
                    <button id="high-contrast-btn" class="btn-accessibility" title="ê³ ëŒ€ë¹„ ëª¨ë“œ" aria-label="ê³ ëŒ€ë¹„ ëª¨ë“œ">
                        ğŸŒ“
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- ê²°ê³¼ í—¤ë” -->
    <div class="result-header">
        <div class="max-w-7xl mx-auto">
            <div class="text-6xl mb-4">ğŸ‰</div>
            <h2 class="text-3xl font-bold mb-2">ë³µì§€ í˜œíƒ ì¶”ì²œ ê²°ê³¼</h2>
            <p class="text-blue-100 text-lg mb-2" id="user-greeting">
                ì–´ë¥´ì‹ ê»˜ ë§ëŠ” ë³µì§€ í˜œíƒì„ ì°¾ì•˜ìŠµë‹ˆë‹¤
            </p>
            <p class="text-blue-200 text-sm" id="completion-date">
                <!-- ì™„ë£Œ ë‚ ì§œê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </p>
            
            <div class="result-stats" id="result-stats">
                <div class="stat-card">
                    <span class="stat-number" id="total-recommendations">0</span>
                    <span class="stat-label">ì¶”ì²œ ë³µì§€ í˜œíƒ</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="confidence-score">0%</span>
                    <span class="stat-label">ë¶„ì„ ì •í™•ë„</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="user-key-display">-</span>
                    <span class="stat-label">ì¡°íšŒ í‚¤</span>
                </div>
            </div>
        </div>
    </div>

    <!-- ë©”ì¸ ì½˜í…ì¸  -->
    <main id="main-content" class="max-w-7xl mx-auto px-4 py-8">
        <div class="max-w-4xl mx-auto">
            <!-- ì¶”ì²œ ê²°ê³¼ ëª©ë¡ -->
            <div id="recommendations-container">
                <!-- ì¶”ì²œ ê²°ê³¼ê°€ ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
            </div>

            <!-- í•˜ë‹¨ ì•¡ì…˜ -->
            <div class="mt-12 bg-white rounded-lg p-6 shadow-sm border border-gray-200">
                <div class="text-center">
                    <h3 class="text-xl font-semibold mb-4">ê²°ê³¼ë¥¼ ì €ì¥í•˜ê³  ë‚˜ì¤‘ì— í™•ì¸í•˜ì„¸ìš”</h3>
                    <p class="text-gray-600 mb-6">
                        ìœ„ì˜ <strong id="user-key-text">ì¡°íšŒ í‚¤</strong>ë¥¼ ê¸°ë¡í•´ë‘ì‹œë©´ ì–¸ì œë“ ì§€ ê²°ê³¼ë¥¼ ë‹¤ì‹œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                    </p>
                    <div class="flex flex-col sm:flex-row justify-center gap-4">
                        <button id="print-btn" class="btn btn-primary">
                            ğŸ–¨ï¸ ê²°ê³¼ ì¸ì‡„í•˜ê¸°
                        </button>
                        <button id="save-btn" class="btn btn-secondary">
                            ğŸ“± ì¡°íšŒ í‚¤ ì €ì¥í•˜ê¸°
                        </button>
                        <button id="new-survey-btn" class="btn btn-outline">
                            ğŸ”„ ìƒˆë¡œìš´ ì„¤ë¬¸í•˜ê¸°
                        </button>
                    </div>
                </div>
            </div>

            <!-- ì¶”ê°€ ë„ì›€ë§ -->
            <div class="mt-8 bg-blue-50 rounded-lg p-6 border border-blue-200">
                <h3 class="text-lg font-semibold text-blue-900 mb-3">ğŸ“‹ ë³µì§€ ì‹ ì²­ ë„ì›€ë§</h3>
                <div class="text-blue-800 space-y-2">
                    <p>â€¢ ë³µì§€ ì‹ ì²­ ì‹œ ì‹ ë¶„ì¦ê³¼ ê´€ë ¨ ì„œë¥˜ë¥¼ ì¤€ë¹„í•´ì£¼ì„¸ìš”</p>
                    <p>â€¢ ìÂ·ë©´ í–‰ì •ë³µì§€ì„¼í„°ì—ì„œ ì§ì ‘ ë„ì›€ì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
                    <p>â€¢ ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ ë‚¨í•´êµ°ì²­ ë³µì§€ì •ì±…ê³¼(055-860-8300)ë¡œ ì—°ë½ì£¼ì„¸ìš”</p>
                </div>
            </div>
        </div>
    </main>

    <!-- í‘¸í„° -->
    <footer class="bg-gray-800 text-white mt-16">
        <div class="max-w-7xl mx-auto px-4 py-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <h4 class="text-lg font-semibold mb-4">ë‚¨í•´êµ°ì²­</h4>
                    <p class="text-gray-300">ê²½ìƒë‚¨ë„ ë‚¨í•´êµ° ë‚¨í•´ì í™í˜„ê¸¸ 35</p>
                    <p class="text-gray-300">ì „í™”: 055-860-8000</p>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4">ë¬¸ì˜ ë° ë„ì›€</h4>
                    <p class="text-gray-300">ë³µì§€ì •ì±…ê³¼: 055-860-8300</p>
                    <p class="text-gray-300">ê¸°ìˆ ì§€ì›: 055-860-8100</p>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4">ì´ìš© ì•ˆë‚´</h4>
                    <a href="#" class="text-gray-300 hover:text-white block">ì‚¬ìš© ë°©ë²•</a>
                    <a href="#" class="text-gray-300 hover:text-white block">ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨</a>
                </div>
            </div>
            <div class="mt-8 pt-8 border-t border-gray-700 text-center text-gray-400">
                <p>&copy; 2024 ë‚¨í•´êµ°ì²­. ëª¨ë“  ê¶Œë¦¬ ë³´ìœ .</p>
            </div>
        </div>
    </footer>

    <!-- í”Œë¡œíŒ… ìŒì„± ë²„íŠ¼ -->
    <div class="floating-voice" id="floating-voice-btn" title="ìŒì„± ì•ˆë‚´" aria-label="ìŒì„± ì•ˆë‚´ ë²„íŠ¼">
        ğŸ”Š
    </div>

    <!-- ë³µì§€ ìƒì„¸ ì •ë³´ ëª¨ë‹¬ -->
    <div id="welfare-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen px-4">
            <div class="bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-xl font-bold" id="modal-title">ë³µì§€ ìƒì„¸ ì •ë³´</h3>
                        <button id="modal-close" class="text-gray-400 hover:text-gray-600">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <div id="modal-content">
                        <!-- ëª¨ë‹¬ ë‚´ìš©ì´ ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let isVoiceEnabled = false;
        let isHighContrast = false;
        let fontSizeLevel = 1;
        let speechSynthesis = window.speechSynthesis;
        let resultData = null;
        
        // API ê¸°ë³¸ URL
        const API_BASE_URL = 'http://localhost:5000/api';
        
        // DOM ìš”ì†Œë“¤
        const recommendationsContainer = document.getElementById('recommendations-container');
        const userGreeting = document.getElementById('user-greeting');
        const completionDate = document.getElementById('completion-date');
        const totalRecommendations = document.getElementById('total-recommendations');
        const confidenceScore = document.getElementById('confidence-score');
        const userKeyDisplay = document.getElementById('user-key-display');
        const userKeyText = document.getElementById('user-key-text');
        const printBtn = document.getElementById('print-btn');
        const saveBtn = document.getElementById('save-btn');
        const newSurveyBtn = document.getElementById('new-survey-btn');
        const welfareModal = document.getElementById('welfare-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalContent = document.getElementById('modal-content');
        const modalClose = document.getElementById('modal-close');
        const fontSizeBtn = document.getElementById('font-size-btn');
        const voiceToggleBtn = document.getElementById('voice-toggle-btn');
        const highContrastBtn = document.getElementById('high-contrast-btn');
        const floatingVoiceBtn = document.getElementById('floating-voice-btn');
        const mainBody = document.getElementById('main-body');
        
        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            loadUserPreferences();
            initializeEventListeners();
            loadResults();
        });
        
        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì´ˆê¸°í™”
        function initializeEventListeners() {
            printBtn.addEventListener('click', printResults);
            saveBtn.addEventListener('click', saveUserKey);
            newSurveyBtn.addEventListener('click', startNewSurvey);
            modalClose.addEventListener('click', closeModal);
            
            // ì ‘ê·¼ì„± ë²„íŠ¼ë“¤
            fontSizeBtn.addEventListener('click', toggleFontSize);
            voiceToggleBtn.addEventListener('click', toggleVoice);
            highContrastBtn.addEventListener('click', toggleHighContrast);
            floatingVoiceBtn.addEventListener('click', toggleVoice);
            
            // ëª¨ë‹¬ ë°°ê²½ í´ë¦­ ì‹œ ë‹«ê¸°
            welfareModal.addEventListener('click', function(e) {
                if (e.target === welfareModal) {
                    closeModal();
                }
            });
            
            // í‚¤ë³´ë“œ ì ‘ê·¼ì„±
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeModal();
                }
            });
        }
        
        // ê²°ê³¼ ë°ì´í„° ë¡œë“œ
        async function loadResults() {
            // URLì—ì„œ userKey íŒŒë¼ë¯¸í„° ì¶”ì¶œ
            const urlParams = new URLSearchParams(window.location.search);
            const userKey = urlParams.get('userKey');
            
            if (!userKey) {
                alert('ì˜ëª»ëœ ì ‘ê·¼ì…ë‹ˆë‹¤.');
                window.location.href = 'index.html';
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE_URL}/results/${userKey}`);
                const data = await response.json();
                
                if (response.ok) {
                    resultData = data;
                    displayResults(data);
                    
                    if (isVoiceEnabled) {
                        speak(`${data.user_name}ë‹˜ì˜ ë³µì§€ ì¶”ì²œ ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.`);
                    }
                } else {
                    alert('ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + data.error);
                    window.location.href = 'index.html';
                }
            } catch (error) {
                console.error('Error:', error);
                alert('ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                window.location.href = 'index.html';
            }
        }
        
        // ê²°ê³¼ í‘œì‹œ
        function displayResults(data) {
            // í—¤ë” ì •ë³´ ì—…ë°ì´íŠ¸
            userGreeting.textContent = `${data.user_name}ë‹˜ê»˜ ë§ëŠ” ${data.recommendations.length}ê°€ì§€ ë³µì§€ í˜œíƒì„ ì°¾ì•˜ìŠµë‹ˆë‹¤`;
            completionDate.textContent = `ì™„ë£Œì¼: ${formatDate(data.completion_time)}`;
            
            // í†µê³„ ì •ë³´ ì—…ë°ì´íŠ¸
            totalRecommendations.textContent = data.recommendations.length;
            confidenceScore.textContent = `${Math.round(data.confidence_score || 85)}%`;
            
            // userKey ì¶”ì¶œ (URLì—ì„œ)
            const urlParams = new URLSearchParams(window.location.search);
            const userKey = urlParams.get('userKey');
            userKeyDisplay.textContent = userKey;
            userKeyText.textContent = userKey;
            
            // ì¶”ì²œ ê²°ê³¼ ë Œë”ë§
            renderRecommendations(data.recommendations);
        }
        
        // ì¶”ì²œ ê²°ê³¼ ë Œë”ë§
        function renderRecommendations(recommendations) {
            recommendationsContainer.innerHTML = '';
            
            recommendations.forEach((welfare, index) => {
                const welfareCard = document.createElement('div');
                welfareCard.className = `welfare-card priority-${welfare.priority}`;
                
                const categoryClass = getCategoryClass(welfare.category);
                
                welfareCard.innerHTML = `
                    <div class="p-6">
                        <div class="flex items-start justify-between">
                            <div class="flex-1">
                                <div class="flex items-center gap-2 mb-3">
                                    <span class="priority-badge priority-${welfare.priority}">
                                        ${welfare.priority}ìˆœìœ„
                                    </span>
                                    <span class="category-badge ${categoryClass}">
                                        ${getCategoryIcon(welfare.category)} ${welfare.category}
                                    </span>
                                </div>
                                <h3 class="text-xl font-bold text-gray-800 mb-2">
                                    ${welfare.name}
                                </h3>
                                <p class="text-gray-600 mb-4">
                                    ${welfare.description}
                                </p>
                                <div class="flex flex-wrap items-center gap-4 text-sm text-gray-500 mb-4">
                                    <span>ğŸ’° ${welfare.benefit_amount}</span>
                                    <span>ğŸ“‹ ${welfare.benefit_type}</span>
                                    <span>ğŸ¯ ì í•©ë„ ${welfare.match_score}%</span>
                                </div>
                            </div>
                            <div class="ml-4">
                                <div class="text-4xl">${getCategoryIcon(welfare.category)}</div>
                            </div>
                        </div>
                        <div class="mt-6 flex gap-3">
                            <button class="btn btn-primary" onclick="showWelfareDetails('${welfare.id}')">
                                ì‹ ì²­ ë°©ë²• ë³´ê¸°
                            </button>
                            <button class="btn btn-secondary" onclick="showWelfareDetails('${welfare.id}')">
                                ìƒì„¸ ì •ë³´
                            </button>
                            <button class="btn btn-outline" onclick="speakWelfare('${welfare.name}', '${welfare.description}')">
                                ğŸ”Š ìŒì„± ì•ˆë‚´
                            </button>
                        </div>
                    </div>
                `;
                
                recommendationsContainer.appendChild(welfareCard);
            });
        }
        
        // ë³µì§€ ìƒì„¸ ì •ë³´ í‘œì‹œ
        function showWelfareDetails(welfareId) {
            const welfare = resultData.recommendations.find(w => w.id === welfareId);
            
            if (!welfare) {
                alert('ë³µì§€ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            modalTitle.textContent = welfare.name;
            modalContent.innerHTML = `
                <div class="space-y-6">
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-2">ğŸ“‹ ì§€ì› ë‚´ìš©</h4>
                        <p class="text-gray-600">${welfare.description}</p>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <h4 class="font-semibold text-gray-800 mb-2">ğŸ’° ì§€ì› ê¸ˆì•¡</h4>
                            <p class="text-gray-600">${welfare.benefit_amount}</p>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-800 mb-2">ğŸ“¦ ì§€ì› í˜•íƒœ</h4>
                            <p class="text-gray-600">${welfare.benefit_type}</p>
                        </div>
                    </div>
                    
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-2">ğŸ“ ì‹ ì²­ ë°©ë²•</h4>
                        <div class="bg-gray-50 p-4 rounded-lg">
                            ${getApplicationMethod(welfare)}
                        </div>
                    </div>
                    
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-2">ğŸ“„ í•„ìš” ì„œë¥˜</h4>
                        <div class="bg-gray-50 p-4 rounded-lg">
                            ${getRequiredDocuments(welfare)}
                        </div>
                    </div>
                    
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-2">ğŸ“ ë¬¸ì˜ì²˜</h4>
                        <div class="bg-blue-50 p-4 rounded-lg">
                            ${getContactInfo(welfare)}
                        </div>
                    </div>
                </div>
            `;
            
            welfareModal.classList.remove('hidden');
            
            if (isVoiceEnabled) {
                speak(`${welfare.name}ì˜ ìƒì„¸ ì •ë³´ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.`);
            }
        }
        
        // ëª¨ë‹¬ ë‹«ê¸°
        function closeModal() {
            welfareModal.classList.add('hidden');
        }
        
        // ë³µì§€ ìŒì„± ì•ˆë‚´
        function speakWelfare(name, description) {
            speak(`${name}. ${description}`);
        }
        
        // ê²°ê³¼ ì¸ì‡„
        function printResults() {
            if (isVoiceEnabled) {
                speak('ê²°ê³¼ë¥¼ ì¸ì‡„í•©ë‹ˆë‹¤.');
            }
            
            window.print();
        }
        
        // ì¡°íšŒ í‚¤ ì €ì¥
        function saveUserKey() {
            const urlParams = new URLSearchParams(window.location.search);
            const userKey = urlParams.get('userKey');
            
            if (navigator.clipboard) {
                navigator.clipboard.writeText(userKey).then(() => {
                    alert(`ì¡°íšŒ í‚¤ "${userKey}"ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                    
                    if (isVoiceEnabled) {
                        speak('ì¡°íšŒ í‚¤ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.');
                    }
                }).catch(() => {
                    alert(`ì¡°íšŒ í‚¤: ${userKey}\n\nì´ í‚¤ë¥¼ ê¸°ë¡í•´ë‘ì„¸ìš”.`);
                });
            } else {
                alert(`ì¡°íšŒ í‚¤: ${userKey}\n\nì´ í‚¤ë¥¼ ê¸°ë¡í•´ë‘ì„¸ìš”.`);
            }
        }
        
        // ìƒˆë¡œìš´ ì„¤ë¬¸ ì‹œì‘
        function startNewSurvey() {
            if (confirm('ìƒˆë¡œìš´ ì„¤ë¬¸ì„ ì‹œì‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                window.location.href = 'index.html';
            }
        }
        
        // ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤
        function getCategoryClass(category) {
            const categoryMap = {
                'ê±´ê°•ì˜ë£Œ': 'health',
                'ìƒí™œì§€ì›': 'life',
                'ê²½ì œì§€ì›': 'economic',
                'ì‚¬íšŒì°¸ì—¬': 'social',
                'ì£¼ê±°ì§€ì›': 'housing'
            };
            return categoryMap[category] || 'health';
        }
        
        function getCategoryIcon(category) {
            const iconMap = {
                'ê±´ê°•ì˜ë£Œ': 'ğŸ¥',
                'ìƒí™œì§€ì›': 'ğŸ ',
                'ê²½ì œì§€ì›': 'ğŸ’°',
                'ì‚¬íšŒì°¸ì—¬': 'ğŸ‘¥',
                'ì£¼ê±°ì§€ì›': 'ğŸ¡'
            };
            return iconMap[category] || 'ğŸ“‹';
        }
        
        function getApplicationMethod(welfare) {
            const methodMap = {
                'basic_pension': 'ìÂ·ë©´ í–‰ì •ë³µì§€ì„¼í„° ë°©ë¬¸ ë˜ëŠ” ì˜¨ë¼ì¸ ì‹ ì²­<br><a href="https://www.bokjiro.go.kr" target="_blank" class="text-blue-600">ë³µì§€ë¡œ ë°”ë¡œê°€ê¸°</a>',
                'namhae_customized_care': 'ê±°ì£¼ì§€ ê´€í•  ìÂ·ë©´ í–‰ì •ë³µì§€ì„¼í„° ë°©ë¬¸ ë˜ëŠ” ì „í™” ìƒë‹´<br>ì „í™”: 055-860-8300',
                'health_medical_support': 'ê´€í•  ë³´ê±´ì†Œ ë°©ë¬¸ ì‹ ì²­<br>ë‚¨í•´êµ° ë³´ê±´ì†Œ: 055-860-8000',
                'senior_jobs': 'ì‹œÂ·êµ°Â·êµ¬ ë˜ëŠ” ìˆ˜í–‰ê¸°ê´€ì—ì„œ ê´€ë ¨ ì„œë¥˜ ì œì¶œ<br>ë‚¨í•´êµ°ì²­ ë…¸ì¸ë³µì§€ê³¼: 055-860-8300',
                'senior_housing': 'í•´ë‹¹ ì‹œì„¤ ë˜ëŠ” ì‹œÂ·êµ°Â·êµ¬ ë‹´ë‹¹ ë¶€ì„œì— ë¬¸ì˜',
                'basic_livelihood': 'ê±°ì£¼ì§€ ê´€í•  ìÂ·ë©´ í–‰ì •ë³µì§€ì„¼í„° ë°©ë¬¸ ì‹ ì²­'
            };
            return methodMap[welfare.id] || 'ê´€í•  í–‰ì •ë³µì§€ì„¼í„° ë˜ëŠ” ë‚¨í•´êµ°ì²­ ë³µì§€ì •ì±…ê³¼(055-860-8300)ì— ë¬¸ì˜í•´ì£¼ì„¸ìš”.';
        }
        
        function getRequiredDocuments(welfare) {
            const docMap = {
                'basic_pension': 'â€¢ ì‹ ë¶„ì¦<br>â€¢ ê¸°ì´ˆì—°ê¸ˆ ì‹ ì²­ì„œ<br>â€¢ ì†Œë“ì¬ì‚° ì‹ ê³ ì„œ<br>â€¢ í†µì¥ ì‚¬ë³¸',
                'namhae_customized_care': 'â€¢ ì‹ ë¶„ì¦<br>â€¢ ì†Œë“ í™•ì¸ ì„œë¥˜<br>â€¢ ê±´ê°• ìƒíƒœ í™•ì¸ì„œ(í•´ë‹¹ì‹œ)',
                'health_medical_support': 'â€¢ ì‹ ë¶„ì¦<br>â€¢ ì˜ë£Œì§„ë‹¨ì„œ<br>â€¢ ì†Œë“ í™•ì¸ ì„œë¥˜<br>â€¢ ì˜ë£Œë¹„ ì˜ìˆ˜ì¦',
                'senior_jobs': 'â€¢ ì‹ ë¶„ì¦<br>â€¢ ì°¸ì—¬ì‹ ì²­ì„œ<br>â€¢ ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë™ì˜ì„œ<br>â€¢ ê´€ë ¨ ìê²©ì¦(í•´ë‹¹ì‹œ)',
                'senior_housing': 'â€¢ ì‹ ë¶„ì¦<br>â€¢ ì†Œë“ í™•ì¸ ì„œë¥˜<br>â€¢ ê±´ê°•ì§„ë‹¨ì„œ<br>â€¢ ì…ì†Œ ì‹ ì²­ì„œ',
                'basic_livelihood': 'â€¢ ì‹ ë¶„ì¦<br>â€¢ ì†Œë“ í™•ì¸ ì„œë¥˜<br>â€¢ ì¬ì‚° í™•ì¸ ì„œë¥˜<br>â€¢ ê°€ì¡±ê´€ê³„ ì¦ëª…ì„œ'
            };
            return docMap[welfare.id] || 'ìì„¸í•œ ì„œë¥˜ëŠ” í•´ë‹¹ ê¸°ê´€ì— ë¬¸ì˜í•´ì£¼ì„¸ìš”.';
        }
        
        function getContactInfo(welfare) {
            const contactMap = {
                'basic_pension': 'êµ­ë¯¼ì—°ê¸ˆê³µë‹¨ ì½œì„¼í„°: 1355<br>ë‚¨í•´êµ°ì²­ ë³µì§€ì •ì±…ê³¼: 055-860-8300',
                'namhae_customized_care': 'ë‚¨í•´êµ°ì²­ ë…¸ì¸ë³µì§€ê³¼: 055-860-8300',
                'health_medical_support': 'ë‚¨í•´êµ° ë³´ê±´ì†Œ: 055-860-8000',
                'senior_jobs': 'ë‚¨í•´êµ°ì²­ ë…¸ì¸ë³µì§€ê³¼: 055-860-8300',
                'senior_housing': 'ë‚¨í•´êµ°ì²­ ë³µì§€ì •ì±…ê³¼: 055-860-8300',
                'basic_livelihood': 'ë‚¨í•´êµ°ì²­ ë³µì§€ì •ì±…ê³¼: 055-860-8300'
            };
            return contactMap[welfare.id] || 'ë‚¨í•´êµ°ì²­ ë³µì§€ì •ì±…ê³¼: 055-860-8300<br>ë‚¨í•´êµ°ì²­ ëŒ€í‘œì „í™”: 055-860-8000';
        }
        
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('ko-KR', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }
        
        // ì ‘ê·¼ì„± ê¸°ëŠ¥ë“¤ (ì´ì „ í˜ì´ì§€ì™€ ë™ì¼)
        function toggleFontSize() {
            fontSizeLevel = (fontSizeLevel % 3) + 1;
            
            const body = document.body;
            body.classList.remove('text-size-normal', 'text-size-medium', 'text-size-large');
            
            switch (fontSizeLevel) {
                case 1:
                    body.classList.add('text-size-normal');
                    break;
                case 2:
                    body.classList.add('text-size-medium');
                    break;
                case 3:
                    body.classList.add('text-size-large');
                    break;
            }
            
            localStorage.setItem('fontSizeLevel', fontSizeLevel);
            
            if (isVoiceEnabled) {
                speak(`ê¸€ì í¬ê¸°ë¥¼ ${fontSizeLevel}ë‹¨ê³„ë¡œ ì¡°ì ˆí–ˆìŠµë‹ˆë‹¤.`);
            }
        }
        
        function toggleVoice() {
            isVoiceEnabled = !isVoiceEnabled;
            
            if (isVoiceEnabled) {
                voiceToggleBtn.classList.add('bg-blue-100', 'border-blue-500');
                floatingVoiceBtn.classList.add('bg-blue-700');
                speak('ìŒì„± ì•ˆë‚´ê°€ ì¼œì¡ŒìŠµë‹ˆë‹¤.');
            } else {
                voiceToggleBtn.classList.remove('bg-blue-100', 'border-blue-500');
                floatingVoiceBtn.classList.remove('bg-blue-700');
                
                if (speechSynthesis.speaking) {
                    speechSynthesis.cancel();
                }
            }
            
            localStorage.setItem('isVoiceEnabled', isVoiceEnabled);
        }
        
        function toggleHighContrast() {
            isHighContrast = !isHighContrast;
            
            if (isHighContrast) {
                mainBody.classList.add('high-contrast');
                highContrastBtn.classList.add('bg-yellow-400', 'border-yellow-600');
            } else {
                mainBody.classList.remove('high-contrast');
                highContrastBtn.classList.remove('bg-yellow-400', 'border-yellow-600');
            }
            
            localStorage.setItem('isHighContrast', isHighContrast);
            
            if (isVoiceEnabled) {
                speak(`ê³ ëŒ€ë¹„ ëª¨ë“œê°€ ${isHighContrast ? 'ì¼œì¡ŒìŠµë‹ˆë‹¤' : 'êº¼ì¡ŒìŠµë‹ˆë‹¤'}.`);
            }
        }
        
        function speak(text) {
            if (!speechSynthesis) return;
            
            if (speechSynthesis.speaking) {
                speechSynthesis.cancel();
            }
            
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'ko-KR';
            utterance.rate = 0.8;
            utterance.pitch = 1;
            
            speechSynthesis.speak(utterance);
        }
        
        function loadUserPreferences() {
            const savedFontSize = localStorage.getItem('fontSizeLevel');
            if (savedFontSize) {
                fontSizeLevel = parseInt(savedFontSize);
                const body = document.body;
                body.classList.remove('text-size-normal', 'text-size-medium', 'text-size-large');
                
                switch (fontSizeLevel) {
                    case 1:
                        body.classList.add('text-size-normal');
                        break;
                    case 2:
                        body.classList.add('text-size-medium');
                        break;
                    case 3:
                        body.classList.add('text-size-large');
                        break;
                }
            }
            
            const savedVoice = localStorage.getItem('isVoiceEnabled');
            if (savedVoice === 'true') {
                isVoiceEnabled = true;
                voiceToggleBtn.classList.add('bg-blue-100', 'border-blue-500');
                floatingVoiceBtn.classList.add('bg-blue-700');
            }
            
            const savedHighContrast = localStorage.getItem('isHighContrast');
            if (savedHighContrast === 'true') {
                isHighContrast = true;
                mainBody.classList.add('high-contrast');
                highContrastBtn.classList.add('bg-yellow-400', 'border-yellow-600');
            }
        }
    </script>
</body>
</html> 